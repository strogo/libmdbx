<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libmdbx: ChangeLog</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libmdbx
   &#160;<span id="projectnumber">0.9.1.4 (2020-10-01T02:28:10+03:00)</span>
   </div>
   <div id="projectbrief">One of the fastest compact embeddable key-value ACID database without WAL.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__change_log.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ChangeLog </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md54"></a>
v0.9.2 (in development)</h1>
<p>TODO:</p>
<ul>
<li>Rework/speedup the implementation of the dirty page list (lazy compactification, lazy sorting via merge).</li>
<li>Finalize C++ API (few typos and trivia bugs are likely for now).</li>
<li>Packages for ROSA Linux, ALT Linux, Fedora/RHEL, Debian/Ubuntu.</li>
</ul>
<h1><a class="anchor" id="autotoc_md55"></a>
v0.9.1 2020-09-30</h1>
<p>Added features:</p>
<ul>
<li>Preliminary C++ API with support for C++17 polymorphic allocators.</li>
<li><a href="https://erthink.github.io/libmdbx/">Online C++ API reference</a> by Doxygen.</li>
<li>Quick reference for Insert/Update/Delete operations.</li>
<li>Explicit <code>MDBX_SYNC_DURABLE</code> to sync modes for API clarity.</li>
<li>Explicit <code>MDBX_ALLDUPS</code> and <code>MDBX_UPSERT</code> for API clarity.</li>
<li>Support for read transactions preparation (<code>MDBX_TXN_RDONLY_PREPARE</code> flag).</li>
<li>Support for cursor preparation/(pre)allocation and reusing (<code><a class="el" href="group__c__cursors.html#ga222d6d6ed1be472df4da3151e2225a7a" title="Create a cursor handle but not bind it to transaction nor DBI handle.">mdbx_cursor_create()</a></code> and <code><a class="el" href="group__c__cursors.html#ga5e9097503883404327e77d29623b8b25" title="Bind cursor to specified transaction and DBI handle.">mdbx_cursor_bind()</a></code> functions).</li>
<li>Support for checking database using specified meta-page (see <code>mdbx_chk -h</code>).</li>
<li>Support for turn to the specific meta-page after checking (see <code>mdbx_chk -h</code>).</li>
<li>Support for explicit reader threads (de)registration.</li>
<li>The <code><a class="el" href="group__c__transactions.html#ga04465e60a2337ce8472274b1a580b7fc" title="Marks transaction as broken.">mdbx_txn_break()</a></code> function to explicitly mark a transaction as broken.</li>
<li>Improved handling of corrupted databases by <code>mdbx_chk</code> utility and <code>mdbx_walk_tree()</code> function.</li>
<li>Improved DB corruption detection by checking parent-page-txnid.</li>
<li>Improved opening large DB (&gt; 4Gb) from 32-bit code.</li>
<li>Provided <code>pure-function</code> and <code>const-function</code> attributes to C API.</li>
<li>Support for user-settable context for transactions &amp; cursors.</li>
<li>Revised API and documentation related to Handle-Slow-Readers callback feature.</li>
</ul>
<p>Deprecated functions and flags:</p>
<ul>
<li>For clarity and API simplification the <code>MDBX_MAPASYNC</code> flag is deprecated. Just use <code>MDBX_SAFE_NOSYNC</code> or <code>MDBX_UTTERLY_NOSYNC</code> instead of it.</li>
<li><code>MDBX_oom_func</code>, <code>mdbx_env_set_oomfunc()</code> and <code>mdbx_env_get_oomfunc()</code> replaced with <code>MDBX_hsr_func</code>, <code>mdbx_env_get_hsr</code> and <code><a class="el" href="group__c__api.html#ga51e7c3b2699ce294ee23f27a07ff07f6" title="Gets current Handle-Slow-Readers callback used to resolve database full/overflow issue due to a reade...">mdbx_env_get_hsr()</a></code>.</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Fix <code><a class="el" href="group__c__err.html#gaaf73dccece7a7ba2dde3bccb16c3646a" title="Return a string describing a given error code.">mdbx_strerror()</a></code> for <code>MDBX_BUSY</code> error (no error description is returned).</li>
<li>Fix update internal meta-geo information in read-only mode (<code>EACCESS</code> or <code>EBADFD</code> error).</li>
<li>Fix <code>mdbx_page_get()</code> null-defer when DB corrupted (crash by <code>SIGSEGV</code>).</li>
<li>Fix <code><a class="el" href="group__c__opening.html#gabb7dd3b10dd31639ba252df545e11768" title="Open an environment instance.">mdbx_env_open()</a></code> for re-opening after non-fatal errors (<code>mdbx_chk</code> unexpected failures).</li>
<li>Workaround for MSVC 19.27 <code>static_assert()</code> bug.</li>
<li>Doxygen descriptions and refinement.</li>
<li>Update Valgrind's suppressions.</li>
<li>Workaround to avoid infinite loop of 'nested' testcase on MIPS under QEMU.</li>
<li>Fix a lot of typos &amp; spelling (Thanks to Josh Soref for PR).</li>
<li>Fix <code>getopt()</code> messages for Windows (Thanks to Andrey Sporaw for reporting).</li>
<li>Fix MSVC compiler version requirements (Thanks to Andrey Sporaw for reporting).</li>
<li>Workarounds for QEMU's bugs to run tests for cross-builded library under QEMU.</li>
<li>Now C++ compiler optional for building by CMake.</li>
</ul>
<h1><a class="anchor" id="autotoc_md56"></a>
v0.9.0 2020-07-31 (not a release, but API changes)</h1>
<p>Added features:</p>
<ul>
<li><a href="https://erthink.github.io/libmdbx/">Online C API reference</a> by Doxygen.</li>
<li>Separated enums for environment, sub-databases, transactions, copying and data-update flags.</li>
</ul>
<p>Deprecated functions and flags:</p>
<ul>
<li>Usage of custom comparators and the <code><a class="el" href="group__c__dbi.html#ga4c0707cc17d08231d561903f78656cb6">mdbx_dbi_open_ex()</a></code> are deprecated, since such databases couldn't be checked by the <code>mdbx_chk</code> utility. Please use the value-to-key functions to provide keys that are compatible with the built-in libmdbx comparators.</li>
</ul>
<h1><a class="anchor" id="autotoc_md57"></a>
v0.8.2 2020-07-06</h1>
<ul>
<li>Added support multi-opening the same DB in a process with SysV locking (BSD).</li>
<li>Fixed warnings &amp; minors for LCC compiler (E2K).</li>
<li>Enabled to simultaneously open the same database from processes with and without the <code>MDBX_WRITEMAP</code> option.</li>
<li>Added key-to-value, <code><a class="el" href="group__c__extra.html#ga909e442d177b286628210b63d367dab5" title="Returns default internal key&#39;s comparator for given database flags.">mdbx_get_keycmp()</a></code> and <code><a class="el" href="group__c__extra.html#ga7d5d14fe7bb256647535d8e6cc92401f" title="Returns default internal data&#39;s comparator for given database flags.">mdbx_get_datacmp()</a></code> functions (helpful to avoid using custom comparators).</li>
<li>Added <code>ENABLE_UBSAN</code> CMake option to enabling the UndefinedBehaviorSanitizer from GCC/CLANG.</li>
<li>Workaround for <a href="https://bugs.llvm.org/show_bug.cgi?id=43275">CLANG bug</a>.</li>
<li>Returning <code>MDBX_CORRUPTED</code> in case all meta-pages are weak and no other error.</li>
<li>Refined mode bits while auto-creating LCK-file.</li>
<li>Avoids unnecessary database file re-mapping in case geometry changed by another process(es). From the user's point of view, the <code>MDBX_UNABLE_EXTEND_MAPSIZE</code> error will now be returned less frequently and only when using the DB in the current process really requires it to be reopened.</li>
<li>Remapping on-the-fly and of the database file was implemented. Now remapping with a change of address is performed automatically if there are no dependent readers in the current process.</li>
</ul>
<h1><a class="anchor" id="autotoc_md58"></a>
v0.8.1 2020-06-12</h1>
<ul>
<li>Minor change versioning. The last number in the version now means the number of commits since last release/tag.</li>
<li>Provide ChangeLog file.</li>
<li>Fix for using libmdbx as a C-only sub-project with CMake.</li>
<li>Fix <code><a class="el" href="group__c__settings.html#ga79065e4f3c5fb2ad37a52b59224d583e" title="Set all size-related parameters of environment, including page size and the min/max size of the memor...">mdbx_env_set_geometry()</a></code> for case it is called from an opened environment outside of a write transaction.</li>
<li>Add support for huge transactions and <code>MDBX_HUGE_TRANSACTIONS</code> build-option (default <code>OFF</code>).</li>
<li>Refine LTO (link time optimization) for clang.</li>
<li>Force enabling exceptions handling for MSVC (<code>/EHsc</code> option).</li>
</ul>
<h1><a class="anchor" id="autotoc_md59"></a>
v0.8.0 2020-06-05</h1>
<ul>
<li>Support for Android/Bionic.</li>
<li>Support for iOS.</li>
<li>Auto-handling <code>MDBX_NOSUBDIR</code> while opening for any existing database.</li>
<li>Engage github-actions to make release-assets.</li>
<li>Clarify API description.</li>
<li>Extended keygen-cases in stochastic test.</li>
<li>Fix fetching of first/lower key from LEAF2-page during page merge.</li>
<li>Fix missing comma in array of error messages.</li>
<li>Fix div-by-zero while copy-with-compaction for non-resizable environments.</li>
<li>Fixes &amp; enhancements for custom-comparators.</li>
<li>Fix <code>MDBX_AVOID_CRT</code> option and missing <code>ntdll.def</code>.</li>
<li>Fix <code><a class="el" href="group__c__opening.html#ga53cd6249371f8fea6868bb2c35a5623a" title="The shortcut to calling mdbx_env_close_ex() with the dont_sync=false argument.">mdbx_env_close()</a></code> to work correctly called concurrently from several threads.</li>
<li>Fix null-deref in an ASAN-enabled builds while opening the environment with error and/or read-only.</li>
<li>Fix AddressSanitizer errors after closing the environment.</li>
<li>Fix/workaround to avoid GCC 10.x pedantic warnings.</li>
<li>Fix using <code>ENODATA</code> for FreeBSD.</li>
<li>Avoid invalidation of DBI-handle(s) when it just closes.</li>
<li>Avoid using <code>pwritev()</code> for single-writes (up to 10% speedup for some kernels &amp; scenarios).</li>
<li>Avoiding <code>MDBX_UTTERLY_NOSYNC</code> as result of flags merge.</li>
<li>Add <code><a class="el" href="group__c__statinfo.html#ga6bb9689c132368ab6e04997641e42217" title="Retrieve depth (bitmask) information of nested dupsort (multi-value) B+trees for given database.">mdbx_dbi_dupsort_depthmask()</a></code> function.</li>
<li>Add <code>MDBX_CP_FORCE_RESIZEABLE</code> option.</li>
<li>Add deprecated <code>MDBX_MAP_RESIZED</code> for compatibility.</li>
<li>Add <code>MDBX_BUILD_TOOLS</code> option (default <code>ON</code>).</li>
<li>Refine <code><a class="el" href="group__c__dbi.html#ga4c0707cc17d08231d561903f78656cb6">mdbx_dbi_open_ex()</a></code> to safe concurrently opening the same handle from different threads.</li>
<li>Truncate clk-file during environment closing. So a zero-length lck-file indicates that the environment was closed properly.</li>
<li>Refine <code>mdbx_update_gc()</code> for huge transactions with small sizes of database page.</li>
<li>Extends dump/load to support all MDBX attributes.</li>
<li>Avoid upsertion the same key-value data, fix related assertions.</li>
<li>Rework min/max length checking for keys &amp; values.</li>
<li>Checking the order of keys on all pages during checking.</li>
<li>Support <code>CFLAGS_EXTRA</code> make-option for convenience.</li>
<li>Preserve the last txnid while copying with compactification.</li>
<li>Auto-reset running transaction in <a class="el" href="group__c__transactions.html#gaf3cd3707d0154f81f7f73484068246d1" title="Renew a read-only transaction.">mdbx_txn_renew()</a>.</li>
<li>Automatically abort errored transaction in <a class="el" href="group__c__transactions.html#ga26ef82044b516a76e2f22192cfeee84a" title="Commit all the operations of a transaction into the database.">mdbx_txn_commit()</a>.</li>
<li>Auto-choose page size for large databases.</li>
<li>Rearrange source files, rework build, options-support by CMake.</li>
<li>Crutch for WSL1 (Windows subsystem for Linux).</li>
<li>Refine install/uninstall targets.</li>
<li>Support for Valgrind 3.14 and later.</li>
<li>Add check-analyzer check-ubsan check-asan check-leak targets to Makefile.</li>
<li>Minor fix/workaround to avoid UBSAN traps for <code>memcpy(ptr, NULL, 0)</code>.</li>
<li>Avoid some GCC-analyzer false-positive warnings.</li>
</ul>
<h1><a class="anchor" id="autotoc_md60"></a>
v0.7.0 2020-03-18</h1>
<ul>
<li>Workarounds for Wine (Windows compatibility layer for Linux).</li>
<li><code>MDBX_MAP_RESIZED</code> renamed to <code>MDBX_UNABLE_EXTEND_MAPSIZE</code>.</li>
<li>Clarify API description, fix typos.</li>
<li>Speedup runtime checks in debug/checked builds.</li>
<li>Added checking for read/write transactions overlapping for the same thread, added <code>MDBX_TXN_OVERLAPPING</code> error and <code>MDBX_DBG_LEGACY_OVERLAP</code> option.</li>
<li>Added <code><a class="el" href="group__value2key.html#gabcdb5274609f52be6cd01fa5972736ae">mdbx_key_from_jsonInteger()</a></code>, <code><a class="el" href="group__value2key.html#ga5aa537b0d1f41ae7b2c5d76596f18ea5">mdbx_key_from_double()</a></code>, <code><a class="el" href="group__value2key.html#gaa75aa30faf9f2fb8a108b81b1a03a9a1">mdbx_key_from_float()</a></code>, <code><a class="el" href="group__value2key.html#ga48952c5ecb5e5ac86aefb1dbaeea2177">mdbx_key_from_int64()</a></code> and <code><a class="el" href="group__value2key.html#ga3391d0fef6debd88198ab74cb520ea5e">mdbx_key_from_int32()</a></code> functions. See <code><a class="el" href="mdbx_8h.html" title="The libmdbx C API header file.">mdbx.h</a></code> for description.</li>
<li>Fix compatibility (use zero for invalid DBI).</li>
<li>Refine/clarify error messages.</li>
<li>Avoids extra error messages "bad txn" from mdbx_chk when DB is corrupted.</li>
</ul>
<h1><a class="anchor" id="autotoc_md61"></a>
v0.6.0 2020-01-21</h1>
<ul>
<li>Fix <code>mdbx_load</code> utility for custom comparators.</li>
<li>Fix checks related to <code>MDBX_APPEND</code> flag inside <code><a class="el" href="group__c__crud.html#gacd7da9871acab9043665298f3c4996a3" title="Store by cursor.">mdbx_cursor_put()</a></code>.</li>
<li>Refine/fix dbi_bind() internals.</li>
<li>Refine/fix handling <code>STATUS_CONFLICTING_ADDRESSES</code>.</li>
<li>Rework <code>MDBX_DBG_DUMP</code> option to avoid disk I/O performance degradation.</li>
<li>Add built-in help to test tool.</li>
<li>Fix <code><a class="el" href="group__c__settings.html#ga79065e4f3c5fb2ad37a52b59224d583e" title="Set all size-related parameters of environment, including page size and the min/max size of the memor...">mdbx_env_set_geometry()</a></code> for large page size.</li>
<li>Fix env_set_geometry() for large pagesize.</li>
<li>Clarify API description &amp; comments, fix typos.</li>
</ul>
<h1><a class="anchor" id="autotoc_md62"></a>
v0.5.0 2019-12-31</h1>
<ul>
<li>Fix returning MDBX_RESULT_TRUE from page_alloc().</li>
<li>Fix false-positive ASAN issue.</li>
<li>Fix assertion for <code>MDBX_NOTLS</code> option.</li>
<li>Rework <code>MADV_DONTNEED</code> threshold.</li>
<li>Fix <code>mdbx_chk</code> utility for don't checking some numbers if walking on the B-tree was disabled.</li>
<li>Use page's mp_txnid for basic integrity checking.</li>
<li>Add <code>MDBX_FORCE_ASSERTIONS</code> built-time option.</li>
<li>Rework <code>MDBX_DBG_DUMP</code> to avoid performance degradation.</li>
<li>Rename <code>MDBX_NOSYNC</code> to <code>MDBX_SAFE_NOSYNC</code> for clarity.</li>
<li>Interpret <code>ERROR_ACCESS_DENIED</code> from <code>OpenProcess()</code> as 'process exists'.</li>
<li>Avoid using <code>FILE_FLAG_NO_BUFFERING</code> for compatibility with small database pages.</li>
<li>Added install section for CMake.</li>
</ul>
<h1><a class="anchor" id="autotoc_md63"></a>
v0.4.0 2019-12-02</h1>
<ul>
<li>Support for Mac OSX, FreeBSD, NetBSD, OpenBSD, DragonFly BSD, OpenSolaris, OpenIndiana (AIX and HP-UX pending).</li>
<li>Use bootid for decisions of rollback.</li>
<li>Counting retired pages and extended transaction info.</li>
<li>Add <code>MDBX_ACCEDE</code> flag for database opening.</li>
<li>Using OFD-locks and tracking for in-process multi-opening.</li>
<li>Hot backup into pipe.</li>
<li>Support for cmake &amp; amalgamated sources.</li>
<li>Fastest internal sort implementation.</li>
<li>New internal dirty-list implementation with lazy sorting.</li>
<li>Support for lazy-sync-to-disk with polling.</li>
<li>Extended key length.</li>
<li>Last update transaction number for each sub-database.</li>
<li>Automatic read ahead enabling/disabling.</li>
<li>More auto-compactification.</li>
<li>Using -fsanitize=undefined and -Wpedantic options.</li>
<li>Rework page merging.</li>
<li>Nested transactions.</li>
<li>API description.</li>
<li>Checking for non-local filesystems to avoid DB corruption. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
